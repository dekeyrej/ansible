---
# - name: Provision Proxmox-VE VM
#   hosts: iluvatar   # executed on ManwÃ«
#   vars:
#     host_group: seers
#   roles:
#     - role: known-hosts-clear
#     - role: proxmox-provision

# # wait for the Galadriel to wake...
# - name: Wait for Container to become reachable
#   hosts: galadriel
#   gather_facts: no
#   tasks:
#     - name: Wait for SSH to come up
#       ansible.builtin.wait_for_connection:
#         timeout: 300  # Adjust as needed
#         delay: 5      # Initial delay before polling
#         sleep: 5      # Time between retries

- name: setup GPU host
  hosts: galadriel
  become: yes
  roles:
    - role: apt-update-all
    - role: proxmox-lxc-gpu
    - role: apt-add-packages
      vars:
        packages: [ curl, python3-pip, python3-venv ]
    - role: nvidia-install-package
    - role: open-webui-install
    - role: ollama-install
