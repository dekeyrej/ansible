---
- name: python3-kubernetes 
  ansible.builtin.apt:
    pkg: python3-kubernetes

- name: copy app deployment files
  ansible.builtin.copy:
    src: files/deployment
    dest: /home/ubuntu

- name: create microservices apps 
  kubernetes.core.k8s:
    state: present
    src: /home/ubuntu/deployment/{{ item }}.yaml
  loop: "{{ microservices }}"

- name: create nodeapi 
  kubernetes.core.k8s:
    state: present
    src: /home/ubuntu/deployment/nodeapi/{{ item }}.yaml
  loop: "{{ nodeapi }}"

- name: create webdisplay 
  kubernetes.core.k8s:
    state: present
    src: /home/ubuntu/deployment/webdisplay/{{ item }}.yaml
  loop: "{{ webdisplay }}"
